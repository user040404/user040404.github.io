<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>レジストリのバックアップ</title>
    <link rel="stylesheet" href="https://user040404.github.io/normalize.css" />
    <link rel="stylesheet" href="https://user040404.github.io/style.css" />
    <link rel="icon" href="/favicon.svg" />
</head>
<body><header>
<script type="text/javascript" src="//xa.shinobi.jp/ufo/190668700"></script><noscript><a href="//xa.shinobi.jp/bin/gg?190668700" target="_blank"><img src="//xa.shinobi.jp/bin/ll?190668700" border="0"></a><br><span style="font-size:9px"><img style="margin:0;vertical-align:text-bottom;" src="//img.shinobi.jp/tadaima/fj.gif" width="19" height="11"> </span></noscript>
<div id="date"><time datetime="2025-11-01 11:43:23">2025-11-01 11:43:23</time></div>
<div><a href="https://user040404.github.io/">トップページ</a></div>
<h1>レジストリのバックアップ</h1>
<nav id="TableOfContents">
  <ul>
    <li><a href="#はじめに">はじめに</a></li>
    <li><a href="#レジストリ全体のバックアップ">レジストリ全体のバックアップ</a></li>
    <li><a href="#レジストリキーのバックアップ">レジストリキーのバックアップ</a></li>
  </ul>
</nav>
</header>
<div id="content">
<h2 id="はじめに">はじめに</h2>
<p>レジストリをバックアップする方法を紹介します。</p>
<h2 id="レジストリ全体のバックアップ">レジストリ全体のバックアップ</h2>
<p>レジストリ全体をバックアップするには「復元ポイント」を作成します。詳細については<a href="http://windows.microsoft.com/ja-JP/windows7/Create-a-restore-point">復元ポイントを作成する</a>を参照してください。</p>
<p>復元ポイントの作成によってバックアップしたレジストリを復元するには「システムの復元」を実行します。詳細については<a href="http://windows.microsoft.com/ja-JP/windows7/products/features/system-restore">システムの復元</a>を参照してください。</p>
<h2 id="レジストリキーのバックアップ">レジストリキーのバックアップ</h2>
<p>特定のレジストリキーをバックアップするにはレジストリエディタを使用します。詳細については<a href="http://windows.microsoft.com/ja-JP/windows7/Back-up-the-registry">レジストリをバックアップする</a>を参照してください。</p>
<p>ここではPowerShellのスクリプトを使用してレジストリをバックアップする方法を紹介します。</p>
<p>テキストエディタで次のようなスクリプトファイル(*.ps1)を作成してください。</p>


<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">%UserProfile%\export_registry.ps1</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Export-RegistryKey {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>        [Parameter(<span style="color:#a6e22e">Mandatory</span> = $true)]
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$RegistryKeyPath,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        [Parameter(<span style="color:#a6e22e">Mandatory</span> = $true)]
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$OutputFolder
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 出力フォルダが存在するか確認し、存在しなければ作成する</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">-Not</span> (Test-Path -Path $OutputFolder)) {
</span></span><span style="display:flex;"><span>        New-Item -ItemType Directory -Path $OutputFolder
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 出力ファイルのパスを作成する</span>
</span></span><span style="display:flex;"><span>    $KeyName = $RegistryKeyPath <span style="color:#f92672">-replace</span> <span style="color:#e6db74">&#39;[\\:]&#39;</span>, <span style="color:#e6db74">&#39;_&#39;</span>  <span style="color:#75715e"># 無効な文字を置換する</span>
</span></span><span style="display:flex;"><span>    $OutputFile = Join-Path -Path $OutputFolder -ChildPath <span style="color:#e6db74">&#34;</span>${KeyName}<span style="color:#e6db74">.reg&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># レジストリキーをエクスポートする</span>
</span></span><span style="display:flex;"><span>    reg export $RegistryKeyPath $OutputFile /y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># エクスポートを確認する</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (Test-Path -Path $OutputFile) {
</span></span><span style="display:flex;"><span>        Write-Output <span style="color:#e6db74">&#34;レジストリキーは正常にエクスポートされました: </span>$OutputFile<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        Write-Output <span style="color:#e6db74">&#34;レジストリキーのエクスポートに失敗しました。&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Export-MultipleRegistryKeys {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>        [Parameter(<span style="color:#a6e22e">Mandatory</span> = $true)]
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string[]</span>]$RegistryKeyPaths,  <span style="color:#75715e"># 複数キーを配列で受け取る</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        [Parameter(<span style="color:#a6e22e">Mandatory</span> = $true)]
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$OutputFolder
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> ($keyPath <span style="color:#66d9ef">in</span> $RegistryKeyPaths) {
</span></span><span style="display:flex;"><span>        Write-Host <span style="color:#e6db74">&#34;エクスポートしています: </span>$keyPath<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        Export-RegistryKey -RegistryKeyPath $keyPath -OutputFolder $OutputFolder
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># エクスポートするキーのパス</span>
</span></span><span style="display:flex;"><span>$keys = @(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;HKCU\Console&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># エクスポートするキーの出力先</span>
</span></span><span style="display:flex;"><span>$path = Join-Path -Path $HOME -ChildPath <span style="color:#e6db74">&#34;RegistryBackup&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Export-MultipleRegistryKeys -RegistryKeyPaths $keys -OutputFolder $path</span></span></code></pre></div></div>
</figure>
<p>ターミナルで上記のスクリプトを実行します。</p>


<figure class="xCodeBlock">

<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># cd
</span></span><span style="display:flex;"><span># export_registry.ps1</span></span></code></pre></div></div>
</figure>
<p>出力先のフォルダにレジストリファイル(*.reg)が作成されます。レジストリファイルを実行するとレジストリが復元されます。</p>


    </div><footer>
<div>Powered by <a href="https://gohugo.io/">Hugo</a></div>
<div><a target="_blank" href="https://www.amazon.co.jp/b?_encoding=UTF8&tag=foo23-22&linkCode=ur2&linkId=5c65ecd6930af79eab6fbe1abe8e5cb1&camp=247&creative=1211&node=2127209051">Amazonのパソコン・周辺機器</a></div>
</footer>
</body>
</html>
