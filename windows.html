<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windowsのカスタマイズ</title>
    <link rel="stylesheet" href="https://user040404.github.io/normalize.css" />
    <link rel="stylesheet" href="https://user040404.github.io/style.css" />
    <link rel="icon" href="/favicon.svg" />
</head>
<body><header>
<script type="text/javascript" src="//xa.shinobi.jp/ufo/190668700"></script><noscript><a href="//xa.shinobi.jp/bin/gg?190668700" target="_blank"><img src="//xa.shinobi.jp/bin/ll?190668700" border="0"></a><br><span style="font-size:9px"><img style="margin:0;vertical-align:text-bottom;" src="//img.shinobi.jp/tadaima/fj.gif" width="19" height="11"> </span></noscript>
<div id="date"><time datetime="2025-10-29 08:02:00">2025-10-29 08:02:00</time></div>
<div><a href="https://user040404.github.io/">トップページ</a></div>
<h1>Windowsのカスタマイズ</h1>
<nav id="TableOfContents">
  <ul>
    <li><a href="#はじめに">はじめに</a></li>
    <li><a href="#パーティションの分割">パーティションの分割</a></li>
    <li><a href="#パーティションの暗号化">パーティションの暗号化</a></li>
    <li><a href="#システムのカスタマイズ">システムのカスタマイズ</a>
      <ul>
        <li><a href="#自動再生の無効化">自動再生の無効化</a></li>
        <li><a href="#視覚効果の無効化">視覚効果の無効化</a></li>
        <li><a href="#常駐プログラムおよび自動起動の設定">常駐プログラムおよび自動起動の設定</a></li>
      </ul>
    </li>
    <li><a href="#キーバインドのカスタマイズ">キーバインドのカスタマイズ</a></li>
    <li><a href="#アプリケーションのインストール">アプリケーションのインストール</a>
      <ul>
        <li><a href="#ポータブルアプリケーション">ポータブルアプリケーション</a></li>
      </ul>
    </li>
    <li><a href="#ウェブブラウザのカスタマイズ">ウェブブラウザのカスタマイズ</a></li>
    <li><a href="#powershellのカスタマイズ">PowerShellのカスタマイズ</a></li>
  </ul>
</nav>
</header>
<div id="content">
<h2 id="はじめに">はじめに</h2>
<p>Windowsを使い始める前にやっておくべきことを紹介します。</p>
<h2 id="パーティションの分割">パーティションの分割</h2>
<p>WindowsはCドライブにインストールされます。したがってWindowsを再インストールするとCドライブに作成したデータはすべて削除されてしまいます。このような場合に備えてCドライブとは別のドライブにデータを保存するのが一般的です。</p>
<p>PCでは物理的に1台しかないハードディスクを論理的に複数のハードディスクとして扱うことができます。具体的にはハードディスクを区画(パーティション)に分割し、その区画にドライブを割り当てます。</p>
<p>Cドライブが占有しているハードディスクにDドライブを追加するには、Cドライブのパーティションを圧縮して空いたスペースに新しくパーティションを作成し、そのパーティションにDドライブを割り当てます。詳細については<a href="http://support.microsoft.com/kb/944248/ja">Windowsでパーティションを増やすには?</a>を参照してください。</p>
<h2 id="パーティションの暗号化">パーティションの暗号化</h2>
<p>WindowsがインストールされているCドライブ(が割り当てられているパーティション)をシステムドライブ(システムパーティション)といいます。情報漏洩を防ぐためにシステムドライブ以外のドライブのパーティションを<a href="https://ja.wikipedia.org/wiki/VeraCrypt">VeraCrypt</a>で暗号化します。暗号化したパーティションはパスワードを入力して任意のドライブにマウントします。詳細については<a href="https://www.gigafree.net/security/encrypt/VeraCrypt.html">VeraCryptのダウンロードと使い方</a>を参照してください。</p>
<h2 id="システムのカスタマイズ">システムのカスタマイズ</h2>
<p>Windows11でコントロールパネルを開く方法については<a href="https://win11lab.info/win11-controlpanel/">Windows11でコントロールパネルの開き方とショートカットを作る方法</a>を参照してください。</p>
<h3 id="自動再生の無効化">自動再生の無効化</h3>
<ol>
<li>スタートメニューから [コントロール パネル] &gt; [ハードウェアとサウンド] &gt; [自動再生] を選択します。</li>
<li>[すべてのメディアとデバイスで自動再生を使う]のチェックを外して[保存]をクリックします。</li>
</ol>
<h3 id="視覚効果の無効化">視覚効果の無効化</h3>
<ol>
<li>スタートメニューから [コントロール パネル] &gt; [システムとセキュリティ] &gt; [システム] &gt; [システムの詳細設定] を選択します。</li>
<li>[システムのプロパティ]ダイアログの [パフォーマンス] &gt; [設定] をクリックします。</li>
<li>[視覚効果]タブから[パフォーマンスを優先する]をチェックして[OK]をクリックします。</li>
</ol>
<h3 id="常駐プログラムおよび自動起動の設定">常駐プログラムおよび自動起動の設定</h3>
<ol>
<li>検索窓に[msconfig]と入力して[msconfig.exe]を選択します。</li>
<li>[システム構成]ダイアログの以下を設定して[OK]をクリックします。</li>
</ol>
<ul>
<li>[サービス]タブからWindowsの稼動中に常駐させる必要のないプログラムのチェックを外します。</li>
<li>[スタートアップ]タブからWindows起動時に起動する必要のないプログラムのチェックを外します。</li>
</ul>
<h2 id="キーバインドのカスタマイズ">キーバインドのカスタマイズ</h2>
<p><a href="http://satoshi.web5.jp/">ChangeKey</a>でキーバインドを変更します。押しにくい位置にある使用頻度の高いキー(Ctrlキー・Tabキー・Escキーなど)と押しやすい位置にある使用頻度の低いキー(CapsLockキー・Windowsキー・アプリケーションキーなど)を入れ替えます。</p>
<h2 id="アプリケーションのインストール">アプリケーションのインストール</h2>
<p><a href="http://www.forest.impress.co.jp/">窓の杜</a>/<a href="http://www.gigafree.net/">ｋ本的に無料ソフト・フリーソフト</a>/<a href="http://www.softnavi.com/">FreeSoftNavi</a>/<a href="https://freesoft-100.com/">フリーソフト100</a>/<a href="/applications.html">お気に入りのソフト</a>などを参考にして自分に必要なアプリケーションをインストールします。</p>
<h3 id="ポータブルアプリケーション">ポータブルアプリケーション</h3>
<p>ポータブルアプリケーションはUSBメモリなどのメディアに入れて持ち運ぶことができるアプリケーションです。主要なアプリケーションのポータブル版は<a href="https://portableapps.com/ja">PortableApps.com</a>から入手できます。ポータブルアプリケーションはインストール作業が不要であり、フォルダをコピーするだけで簡単にバックアップできます。<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<h2 id="ウェブブラウザのカスタマイズ">ウェブブラウザのカスタマイズ</h2>
<p><a href="https://ja.wikipedia.org/wiki/Mozilla_Firefox">Firefox</a>や<a href="https://ja.wikipedia.org/wiki/Google_Chrome">Chrome</a>には自由に機能を追加できます。</p>
<p><a href="https://ja.wikipedia.org/wiki/UBlock_Origin">uBlock</a>を追加すればウェブページに表示される広告を一掃できます。インストールしたら次の手順にしたがって設定します。</p>
<ol>
<li><a href="https://github.com/tofukko/filter#%E8%B1%86%E8%85%90%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF">豆腐フィルタ</a>(日本用の外部フィルタ)を追加します。</li>
<li>ツールバーのuBlockのアイコンをクリックして[ダッシュボード]のアイコンをクリックします。</li>
<li>外部フィルターの[Myフィルター]と[豆腐フィルタ]を有効にします。SNSのボタンが不要であれば[Fanboy’s Social Blocking List]を有効にします。その他のフィルタは無効にします。</li>
<li>[適用]をクリックします。</li>
</ol>
<p>ウェブページにブロックしたいものがあれば、右クリックメニューから[要素をブロック]を選択します。自動的にフィルタが作成されて[Myフィルター]に登録されます。ブロックしたくないウェブサイトは[ホワイトリスト]に登録します。</p>
<h2 id="powershellのカスタマイズ">PowerShellのカスタマイズ</h2>
<p><a href="https://ja.wikipedia.org/wiki/Windows_Terminal">Windowsターミナル</a>は、文字を入力してコマンドを実行するためのアプリケーションです。たとえば<a href="https://ja.wikipedia.org/wiki/Windows_Package_Manager">Windowsパッケージマネージャ</a>は、ターミナル上でwingetというコマンドを入力して、アプリケーションをインストールしたりアップデートしたりします。このようなコンソールアプリケーション(CUIのアプリケーション)をよく使用するのであれば、ターミナルのフォントや配色を見やすいものにしておきましょう。ターミナル用のフォントとしてCascadiaが用意されています。</p>
<p>ターミナルでWindowsを操作するにはPowerShellを使用します。PowerShellは従来のコマンドプロンプトを置き換えるものです。コマンドプロンプトは機能が乏しく、ほとんど使い物になりませんでした。オブジェクト指向のPowerShellでは、やりたいことを簡単に記述できるようになりました。さまざまなデータとそれらのデータを扱う処理をひとまとめにしたものがオブジェクトです。</p>
<p>PowerShellの最新版をインストールします。</p>


<figure class="xCodeBlock">

<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># winget install Microsoft.PowerShell</span></span></code></pre></div></div>
</figure>
<p>頻繫に行う定型的な作業はPowerShellのスクリプトとして実行できます。スクリプトとは簡易的なプログラムのようなものです。PowerShellのコマンドの使い方やスクリプトの書き方については他の記事を参照してください。スクリプトは自分の手で書く必要はなく、Copilotなどの生成AIに書いてもらうといいでしょう。</p>
<p>PowerShellの起動時に%UserProfile%\Documents\PowerShell\profile.ps1の内容が実行されます。このファイルを使用してPowerShellをカスタマイズできます。ここでは以下のようにしてprofile.dフォルダにあるスクリプトファイル(*.ps1)をインポートするようにします。こうすればスクリプトを目的に応じて複数のファイルに分割できます。</p>


<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">%UserProfile%\Documents\PowerShell\profile.ps1</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e"># サブプロファイルスクリプトのディレクトリパスを設定</span>
</span></span><span style="display:flex;"><span>$path = Split-Path -Path $PROFILE.CurrentUserCurrentHost
</span></span><span style="display:flex;"><span>$profileScriptsPath = Join-Path -Path $path -ChildPath <span style="color:#e6db74">&#34;profile.d&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># profile.dフォルダ内のすべての*.ps1スクリプトをインポート</span>
</span></span><span style="display:flex;"><span>Get-ChildItem -Path $profileScriptsPath -Filter <span style="color:#e6db74">&#34;*.ps1&#34;</span> | ForEach-Object {
</span></span><span style="display:flex;"><span>    . $_.FullName
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
</figure>
<p>settings.ps1にはPowerShellの全般的な設定を記述します。</p>


<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">%UserProfile%\Documents\PowerShell\profile.d\settings.ps1</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e"># コマンドラインのオプションを設定</span>
</span></span><span style="display:flex;"><span>Set-PSReadLineOption -EditMode Emacs <span style="color:#75715e"># 編集モードはWindows/Emacs/Viから選択可能</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 確認メッセージのレベルを設定</span>
</span></span><span style="display:flex;"><span>$ConfirmPreference = <span style="color:#e6db74">&#34;Medium&#34;</span></span></span></code></pre></div></div>
</figure>
<p>aliases.ps1にはコマンドのエイリアス(別名)を指定します。</p>


<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">%UserProfile%\Documents\PowerShell\profile.d\aliases.ps1</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e"># コマンドのエイリアス(別名)を設定</span>
</span></span><span style="display:flex;"><span>Set-Alias -Name c -Value Clear-Host
</span></span><span style="display:flex;"><span>Set-Alias -Name dm -Value Disable-Monitor
</span></span><span style="display:flex;"><span>Set-Alias -Name reboot -Value Restart-Computer
</span></span><span style="display:flex;"><span>Set-Alias -Name halt -Value Stop-Computer
</span></span><span style="display:flex;"><span>Set-Alias -Name code -Value <span style="color:#e6db74">&#34;D:\Applications\VSCode\Code.exe&#34;</span></span></span></code></pre></div></div>
</figure>
<p>functions.ps1には自分が行う作業をコマンドとして定義します。</p>


<figure class="xCodeBlock">
<figcaption class="xCodeBlock_title">%UserProfile%\Documents\PowerShell\profile.d\functions.ps1</figcaption>
<div class="xCodeBlock_code"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#75715e"># 環境変数を取得するコマンド</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Get-Path {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> [<span style="color:#66d9ef">System.Environment</span>]::GetEnvironmentVariable(<span style="color:#e6db74">&#34;Path&#34;</span>, <span style="color:#e6db74">&#34;Machine&#34;</span>) +
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;;&#34;</span> +
</span></span><span style="display:flex;"><span>    [<span style="color:#66d9ef">System.Environment</span>]::GetEnvironmentVariable(<span style="color:#e6db74">&#34;Path&#34;</span>, <span style="color:#e6db74">&#34;User&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 環境変数をリスト表示するコマンド</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Show-Path {
</span></span><span style="display:flex;"><span>    $(Get-Path).Split(<span style="color:#e6db74">&#34;;&#34;</span>).Where({ $_ <span style="color:#f92672">-ne</span> <span style="color:#e6db74">&#34;&#34;</span> }).<span style="color:#66d9ef">ForEach</span>({ Write-Output $_ }) | Sort-Object
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 環境変数を更新するコマンド</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Update-PathVariable {
</span></span><span style="display:flex;"><span>    $env:Path = Get-Path
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ディスプレイをスリープ状態にするコマンド</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Disable-Monitor {
</span></span><span style="display:flex;"><span>    Add-Type -TypeDefinition <span style="color:#e6db74">@&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">using System.Runtime.InteropServices;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">public class Monitor
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    [DllImport(&#34;user32.dll&#34;, CharSet = CharSet.Auto)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, IntPtr wParam, IntPtr lParam);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    public static void TurnOff()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        SendMessage((IntPtr)0xFFFF, 0x0112, (IntPtr)0xF170, (IntPtr)2);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;@</span>
</span></span><span style="display:flex;"><span>    [<span style="color:#66d9ef">Monitor</span>]::TurnOff()
</span></span><span style="display:flex;"><span>    Start-Sleep -Milliseconds <span style="color:#ae81ff">500</span>
</span></span><span style="display:flex;"><span>    rundll32.exe user32.dll, LockWorkStation
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># wget2でウェブサイトをダウンロードするコマンド</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Get-Website {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">param</span> (
</span></span><span style="display:flex;"><span>        [Parameter(<span style="color:#a6e22e">Mandatory</span> = $true)]
</span></span><span style="display:flex;"><span>        [<span style="color:#66d9ef">string</span>]$url
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    wget2 --mirror --convert-links --adjust-extension --page-requisites --no-parent $url
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
</figure>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>インストール作業が必要なアプリケーションでもポータブル版としてインストールできることがあります。&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>


    </div><footer>
<div>Powered by <a href="https://gohugo.io/">Hugo</a></div>
<div><a target="_blank" href="https://www.amazon.co.jp/b?_encoding=UTF8&tag=foo23-22&linkCode=ur2&linkId=5c65ecd6930af79eab6fbe1abe8e5cb1&camp=247&creative=1211&node=2127209051">Amazonのパソコン・周辺機器</a></div>
</footer>
</body>
</html>
